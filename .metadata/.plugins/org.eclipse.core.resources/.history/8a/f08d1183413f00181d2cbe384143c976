package ComparingGenomes;

import methods.ArrayMethods;
import methods.GeneticMethods;

public class Annotation {

	String fileFoundIn;
	String originalCoords;
	int annotationSetIndex;
	int[] coordinates;
	String type;
	char[] sequence;
	char[] reverseCompliment;
	boolean compliment = false;
	
	public Annotation(String coords, String annotationType, String fileFoundIn, int index){
		
		// Store information avbout where curren annotation was found
		this.fileFoundIn = fileFoundIn;
		this.originalCoords = coords;
		this.annotationSetIndex = index;
		this.type = annotationType;
		
		// Parse the coordinate information
		parseCoords(coords);
		
	}
	
	// General methods
	public void parseCoords(String coords){
		
		// Remove ">" or "<" if present
		coords = coords.replace(">", "");
		coords = coords.replace("<", "");
		
		// Check if compliment required
		if(coords.matches("complement(.*)") == true){			
			coords = coords.substring(11, coords.length() - 1);
			compliment = true;
		}
		
		// Check if join present
		if(coords.matches("join(.*)") == true){
			
			coords = coords.substring(5, coords.length() - 1);
			this.coordinates = ArrayMethods.range(ArrayMethods.convertToInteger(coords.split("\\.\\.|,")));			
		}else{
			this.coordinates = ArrayMethods.convertToInteger(coords.split("\\.\\."));
		}		
	}

	public void removeSequences(){
		this.sequence = null;
		this.reverseCompliment = null;
	}
	
	// Getting methods
	public int getStart(){
		return this.coordinates[0];
	}
	public int getEnd(){
		return this.coordinates[1];
	}
	public String getType(){
		return this.type;
	}
	public char[] getSequence(){
		return this.sequence;
	}
	public char[] getReverseCompliment(){
		return this.reverseCompliment;
	}
	
	// Setting methods
	public void setSequence(char[] sequence){
		this.sequence = sequence;
		this.reverseCompliment = GeneticMethods.getReverseCompliment(this.sequence);
	}
}
